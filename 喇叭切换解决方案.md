当然！以下是**简洁版笔记**，方便你保存和快速查阅：

------

### **🎯 目标**

固定使用 USB 声卡（Unitek Y-247A）作为默认音频输出，即使系统自动切换也能自动恢复。

------

### **✅ 1. 创建守护脚本**

bash



```
cat > ～/restore-audio.sh <<'EOF'
#!/bin/bash
TARGET="alsa_output.usb-C-Media_Electronics_Inc._USB_Audio_Device-00.analog-stereo"

while true; do
    CURRENT=$(pactl info 2>/dev/null | grep "Default Sink" | awk '{print $3}')
    if pactl list sinks short | grep -q "$TARGET"; then
        if [[ "$CURRENT" != "$TARGET" ]]; then
            pactl set-default-sink "$TARGET"
            # 迁移正在播放的声音
            for s in $(pactl list sink-inputs short | awk '{print $1}'); do
                pactl move-sink-input "$s" "$TARGET"
            done
        fi
    fi
    sleep 3
done
EOF

chmod +x ～/restore-audio.sh
```

------

### **🔁 2. 设置开机自启（systemd 用户服务）**

bash



```
cat > ～/.config/systemd/user/audio-restore.service <<EOF
[Unit]
Description=Restore audio to USB sound card
After=pipewire.service
Wants=pipewire.service

[Service]
ExecStart=$HOME/restore-audio.sh
Restart=always
RestartSec=5

[Install]
WantedBy=default.target
EOF

systemctl --user daemon-reload
systemctl --user enable --now audio-restore.service
```

------

### **🧪 3. 手动测试**

- 切换到其他设备（如 HDMI）；

- 等 3～5 秒；

- 检查是否自动切回：

  bash

  

  ```
  pactl info | grep "Default Sink"
  ```

------

### **📝 说明**

- 脚本每 3 秒检查一次，默认设备被改就立刻恢复；
- 同时迁移所有正在播放的音频流（避免旧应用无声）；
- 适用于**固定硬件、无法插拔**的机器人场景。

------

> 💡 保存此笔记，部署一次，一劳永逸！

------

需要更精简或做成启动命令？也可以告诉我 😊